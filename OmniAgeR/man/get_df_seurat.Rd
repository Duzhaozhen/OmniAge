% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Brain_CT_clock.R
\name{get_df_seurat}
\alias{get_df_seurat}
\title{Extract and Pre-process Data from a Seurat Object}
\usage{
get_df_seurat(seurat_obj, cell_type, sample_type)
}
\arguments{
\item{seurat_obj}{A Seurat object containing the expression data and metadata
(must include 'donor_id', 'age', 'celltype').}

\item{cell_type}{A character string specifying the cell type to subset.}

\item{sample_type}{A character string defining the processing method:
"SC", "Pseudobulk", or "Bootstrap".}
}
\value{
A data.frame (tibble) containing the processed expression data and metadata.
The structure depends on \code{sample_type}:
\itemize{
\item{"SC": A cell-by-gene matrix with metadata.}
\item{"Pseudobulk": A donor-by-gene matrix (mean expression) with metadata.}
\item{"Bootstrap": A (donor * 100 replicates)-by-gene matrix with metadata.}
}
Returns an empty data.frame if no cells are found for the specified \code{cell_type}.
}
\description{
Subsets a Seurat object by cell type and processes the expression data into one
of three formats: single-cell ('SC'), 'Pseudobulk' (averaged by donor), or
'Bootstrap' (resampled within donor).
}
\details{
This function defines the number of cells to sample for the 'Bootstrap' method
internally via the \code{num_cells} list. If a donor has fewer cells than the
specified number, 100 replicates of the donor's mean expression are returned.
}
