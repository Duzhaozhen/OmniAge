% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PCClocks.R
\name{PCClocks}
\alias{PCClocks}
\title{Calculate Principal Component (PC) Epigenetic Clocks}
\usage{
PCClocks(DNAm, age_v, sex_v, RData)
}
\arguments{
\item{DNAm}{A numeric matrix of DNA methylation (beta) values.
\strong{Samples must be in columns} and CpG probes in rows.}

\item{age_v}{A numeric vector of chronological ages for each sample,
in the same order as the columns of \code{DNAm}.}

\item{sex_v}{A character vector of biological sex for each sample, in the
same order as the columns of \code{DNAm}. Values of "Female" are
encoded as 1; all other values are encoded as 0.}

\item{RData}{A \strong{required} argument specifying the clock data. This can be:
\itemize{
\item A \code{character} string: The path to the \emph{directory} containing the
\code{PCClocks_data.qs2} file.
\item A \code{list}: The pre-loaded data object returned from
\code{load_OmniAgeR_data(object_name = "PCClocks_data")}.
}}
}
\value{
A data.frame containing the original \code{Sample_ID}, \code{Age}, and \code{Female}
columns, appended with 14 new columns for the calculated PC clock values
(e.g., \code{PCHorvath2013}, \code{PCHannum}, \code{PCGrimAge1}, etc.).
}
\description{
Calculates a suite of Principal Component (PC)-based epigenetic clocks
based on the methodology from Higgins-Chen et al. (2022).

This function computes PC-based versions of Horvath2013, Horvath2018, Hannum,
PhenoAge, and GrimAge1, along with their principal components.
}
\details{
PCClocks calculation requires the \code{PCClocks_data.qs2} object, which can be
downloaded using \code{\link[=download_OmniAgeR_data]{download_OmniAgeR_data()}}.

The \code{RData} argument must be provided as either the path to the data
directory (e.g., from \code{get_OmniAgeR_path()}) or the pre-loaded list
object. The advantage of passing the pre-loaded object is that the data
will not be re-loaded on each function call, improving performance when
running the function multiple times (e.g., in a loop).
}
\examples{

# Download the external data
download_OmniAgeR_data(clocks = "PCClocks") #  ZENODO_DOI: "10.5281/zenodo.17162604"

# Either path to the data
RData <- get_OmniAgeR_path()
# OR
RData <- load_OmniAgeR_data(object_name = "PCClocks_data")


download_OmniAgeR_example("Hannum_example")
load_OmniAgeR_example("Hannum_example")
age <- PhenoTypesHannum_lv$Age
sex <- ifelse(PhenoTypesHannum_lv$Sex=="F","Female","Male")
PCClocks.o <- PCClocks(hannum_bmiq_m,age,sex,RData = RData)

}
\references{
Higgins-Chen AT, Thrush KL, Wang Y, et al.
A computational solution for bolstering reliability of epigenetic clocks: Implications for clinical trials and longitudinal tracking.
\emph{Nat Aging.} (2022).
}
