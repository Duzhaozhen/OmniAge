% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CompEpiScores.R
\name{CompEpiScores}
\alias{CompEpiScores}
\title{Calculate Epigenetic Scores for the Circulating Proteome (EpiScores)}
\usage{
CompEpiScores(beta.m, verbose = TRUE)
}
\arguments{
\item{beta.m}{A numeric matrix of normalized DNAm beta values. Rows must correspond to CpG identifiers and columns to samples. \code{NA} values are permitted and will be imputed internally}

\item{verbose}{A logical value (default: \code{TRUE}) indicating whether to print progress messages and warnings (e.g., about missing CpGs) to the console.}
}
\value{
A list of length 109. Each element of the list corresponds to one calculated EpiScore (one for each protein). The name of each list element is the name of the EpiScore. Each element contains a named numeric vector of the calculated scores for all samples.
}
\description{
Computes the 109 validated epigenetic scores (EpiScores) that serve as
DNA methylation-based proxies for the levels of circulating plasma proteins,
as defined by Gadd et al. (2022).
}
\details{
This function implements the method from Gadd et al. (2022) to
calculate the \strong{109 validated EpiScores} for circulating plasma proteins.
The coefficients for these 109 predictors are loaded from the
internal \code{EpiScoresCoef.rda} data object.

\strong{Imputation Handling:}
This function features a robust \strong{two-stage imputation process} for
handling missing CpG data:
\enumerate{
\item \strong{Sample-level NA Imputation:} Any existing \code{NA} values within the
provided \code{beta.m} matrix are imputed to the \strong{row-wise mean}
(the mean of that specific CpG across all samples in the input data).
\item \strong{Missing CpG Imputation:} CpGs required for the scores but
\emph{entirely absent} from \code{beta.m} are added. Their values are imputed
using the \strong{mean beta value from the original training cohort}
(stored in \code{EpiScoresCoef}).
}

After imputation, the function iterates through each unique protein score,
subsetting the appropriate coefficients, and computes a linear predictor
using the \code{calculateLinearPredictor} helper function.
}
\examples{

download_OmniAgeR_example("Hannum_example")
load_OmniAgeR_example("Hannum_example")

all_episcores <- CompEpiScores(hannum_bmiq_m, verbose = TRUE)


}
\references{
Gadd DA, Hillary RF, McCartney DL, et al.
Epigenetic scores for the circulating proteome as tools for disease prediction.
\emph{Elife.} 2022
}
