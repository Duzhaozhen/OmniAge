% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Brain_CT_clock.R
\name{run_prediction_pipeline}
\alias{run_prediction_pipeline}
\title{Run the Full 5-Fold Averaged Prediction Pipeline}
\usage{
run_prediction_pipeline(sample_type, seurat_obj, common_celltypes)
}
\arguments{
\item{sample_type}{The processing method to use: "SC", "Pseudobulk", or
"Bootstrap". This is passed to \code{get_df_seurat}.}

\item{seurat_obj}{The input Seurat object, passed to \code{get_df_seurat}.}

\item{common_celltypes}{A character vector of cell types to process
(e.g., \code{c('Oligodendrocytes', 'Astrocytes')}).}
}
\value{
A single, combined data.frame containing the final (5-fold averaged)
'predictions', 'ages', 'donors', 'sample_type', and 'celltype' for all
requested cell types.
}
\description{
Orchestrates the entire prediction process for a given sample type and set of
cell types. It loads the 5-fold cross-validation models, runs predictions
for each of the 5 folds, and returns the final averaged prediction for
each sample.
}
\details{
This is the main user-facing function for this pipeline. It assumes
that a file named "brain_celltypeSpecific_clocks_coef_imputation_5fold.rda"
exists in the specified path, containing two objects:
\itemize{
\item \code{brain_ct_clocks_coef}: A nested list where keys
(e.g., "SC_Oligodendrocytes") map to a list of 5 models (one for each fold).
\item \code{all_imputation_data_list}: A list where keys
(e.g., "SC_Oligodendrocytes") map to a single imputation data.frame.
}
The function calls \code{get_df_seurat} to prepare the data, then calls
\code{predict_brain_ct_age} five times (once for each fold). The five resulting
prediction vectors are then averaged (row-wise) to produce the final,stable prediction.
}
