% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/UniversalPanMammalianClocks.R
\name{UniversalPanMammalianClocks}
\alias{UniversalPanMammalianClocks}
\title{Calculate Universal Pan-Mammalian Epigenetic Clocks}
\usage{
UniversalPanMammalianClocks(sample_info, beta.m, anage_data, verbose = TRUE)
}
\arguments{
\item{sample_info}{A data.frame with sample metadata. Must include
'Sample' (unique sample ID) and 'SpeciesLatinName' (Latin species name).
Other columns like 'Age' or 'Tissue' are optional but will be included in the output if present.}

\item{beta.m}{A matrix or data.frame of methylation beta values in the format
CpGs x Samples. Rownames must be CpG identifiers, and column names
must be sample identifiers ('Sample') matching those in \code{sample_info}.}

\item{anage_data}{A data.frame containing the AnAge database information.
Must include 'SpeciesLatinName', 'GestationTimeInYears',
'averagedMaturity.yrs', and 'maxAge'. # MODIFIED (Typo fix)}

\item{verbose}{A logical value (default: FALSE) indicating whether to print
detailed progress messages to the console. # NEW}
}
\value{
A data.frame containing the 'Sample', 'SpeciesLatinName',
and the calculated ages: 'DNAmAgePanMammalianClock1',
'DNAmAgePanMammalianClock2', 'DNAmAgePanMammalianClock3',
'DNAmRelativeAge', and 'DNAmRelativeAdultAge'. Any additional columns
from the input \code{sample_info} (like 'Age', 'Tissue') will also be returned.
}
\description{
Applies the three universal pan-mammalian epigenetic clocks (Clock 1, 2, and 3)
from Lu et al. (2023) to a given dataset of DNA methylation values.
}
\details{
This function encapsulates the complete logic from the original publication's
script. It merges sample metadata with AnAge data, processes methylation
values, calculates the three clocks by matrix multiplication with pre-trained
models, and performs the necessary inverse mathematical transformations
to report age in years.
}
\examples{

download_OmniAgeR_example("Tursiops_example")
load_OmniAgeR_example("Tursiops_example")
data("anage_data") ## This anage_data is from https://github.com/shorvath/MammalianMethylationConsortium

# Run the calculation with progress messages

clock_results <- UniversalPanMammalianClocks(
  sample_info = example_sample_info,
  beta.m = example_beta_m,
  anage_data = anage_data,
  verbose = TRUE #
)
}
\references{
Lu, A.T., Fei, Z., Haghani, A. et al.
Universal DNA methylation age across mammalian tissues.
\emph{Nat Aging.} 2023
}
