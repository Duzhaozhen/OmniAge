% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Brain_CT_clock.R
\name{predict_brain_ct_age}
\alias{predict_brain_ct_age}
\title{Apply a Single Clock Model to Expression Data (Vectorized)}
\usage{
predict_brain_ct_age(data, impute_data, model, sample_type)
}
\arguments{
\item{data}{A data.frame of expression data (samples in rows, genes in
columns). Must also contain 'age' and 'donor_id' columns.}

\item{impute_data}{A long-format data.frame with 'feature_name' and
'imputation_value' columns. Used to fill in genes present in the model
but missing from \code{data}.}

\item{model}{A long-format data.frame with 'feature_name' (genes + 'intercept')
and 'coefficient' columns, representing one trained clock.}

\item{sample_type}{A character string (e.g., 'SC', 'Pseudobulk') used to
tag the output data.frame.}
}
\value{
A data.frame with 'predictions' (the predicted age), 'ages' (the true age),
'donors', and 'sample_type'.
}
\description{
Predicts age using a pre-trained elastic net model (coefficients and intercept)
on a given expression data matrix. It handles gene matching, imputation for
missing genes, and vectorized prediction.
}
\details{
This function is the core prediction engine. It performs a matrix
multiplication (\code{expression_matrix \%*\% coefficients_vector + intercept}).
It ensures that the gene order in the expression matrix exactly matches the
coefficient order from the model.
}
\keyword{internal}
